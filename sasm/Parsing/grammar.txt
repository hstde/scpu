start = line*

line = LabelDef? instruction? Comment? Eol

instruction = operation
instruction = directive

operation = op
operation = op operand
operation = op operand Separator operand

op = Mnemonic
op = Identifier

operand = registerAlias
operand = constant
operand = absolute
operand = indirect
operand = displacement
operand = offset

registerAlias = Register
registerAlias = Identifier

constant = Number
constant = Identifier
constant = Char
constant = constExpr

constExpr = addTerm (AddOp addTerm)?
addTerm = mulTerm (MulOp mulTerm)?
mulTerm = constant
mulTerm = LParen constExpr RParen

absolute = LParen constant RParen

indirect = LParen registerAlias RParen

displacement = LParen registerAlias AddOp constant RParen
displacement = LParen constant AddOp(+) registerAlias RParen

offset = LParen registerAlias operator registerAlias RParen

directive = segment
directive = origin
directive = include
directive = times
directive = data
directive = warning
directive = const

segment = Segment Identifier constant?

origin = Origin constant

include = Include String

times = Times constant data

data = DataDefinition dataConstant (Separator dataConstant)*

dataConstant = constant
dataConstant = String

warning = Warning dataConstant (Separator dataConstant)*

const = ConstantDef Identifier dataConstant